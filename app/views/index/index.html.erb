<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> 
<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js"></script> 
<script type="text/javascript">
  function place_marker(address)
  {
    geocoder.geocode( { 'address': address}, function(results, status)
    {
      if (status == google.maps.GeocoderStatus.OK)
      {
        var marker = new google.maps.Marker({
            position: results[0].geometry.location
        });

        markers.push(marker);

        counter++;
      }
      else
      {
        alert("Geocode was not successful for the following reason: " + status);
      }
    });
  };

  function draw_line(points, map) {
    var line = new google.maps.Polyline({
      path: points,
      strokeColor: "#FF0000",
      strokeOpacity: 1.0,
      strokeWeight: 2
    });

    line.setMap(map);
  }
</script>
<script type="text/javascript">
  var geocoder;
  var map;
  var mc = null;
  var markers = [];
  var counter = 0 ;
  var done = 2 ;
  var created ;
 
  function initialize() {
    geocoder = new google.maps.Geocoder();

    var latlng = new google.maps.LatLng(-37.81816020000001, 144.95338830000003);
    var myOptions = {
      zoom: 8,
      center: latlng,
      mapTypeId: google.maps.MapTypeId.TERRAIN
    };

    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

    place_marker("Southern Cross Station Melbourne VIC Australia");
    place_marker("North Melbourne Station Melbourne VIC Australia");

    created = setInterval(create_marker_cluster, 1000)



    var line_points = [
      new google.maps.LatLng(-37.81816020000001, 144.95338830000003),
      new google.maps.LatLng(-37.8070147, 144.94186590000004),
    ];
    draw_line(line_points, map)  
  } ;

  function create_marker_cluster()
  {
    if (counter == done)
    {
      clearInterval ( created );
      mc = new MarkerClusterer(map, markers);
    }
  };

</script>
</head>
<body onload="initialize()">
  <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>